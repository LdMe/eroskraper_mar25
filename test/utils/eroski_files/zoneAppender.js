(function(){define(["t5/core/dom","t5/core/events","t5/core/ajax","t5/core/console","underscore"],function(h,c,e,a,b){var d={zone:{update:"zoneAppender:update",refresh:"zoneAppender:refresh",didUpdate:"zoneAppender:didUpdate",willUpdate:"zoneAppender:willUpdate"}};var f;var g;h.onDocument(d.zone.update,function(j){var i;this.trigger(d.zone.willUpdate);i=j.memo.content;if(i!==void 0){if(g=="up"){this.prepend(i)}else{this.append(i)}}this.trigger(c.initializeComponents);return this.trigger(d.zone.didUpdate,{hasAppended:i!==void 0})});h.onDocument(d.zone.refresh,function(l){var i,k,m,j;j=this.closest("[data-container-type=zone]");i=j.attr("data-zone-parameters");k=i&&JSON.parse(i);m=j.attr("data-simple-ids")?{"t:suppress-namespaced-ids":true}:void 0;return e(l.memo.url,{data:b.extend({"t:zoneid":j.element.id},m,k,l.memo.parameters),success:function(n){var o;return j.trigger(d.zone.update,{content:(o=n.json)!=null&&o.content!==""?o.content:void 0})}})});f=function(k,i,j){g=j;return b.defer(function(){var l;l=h(k);if(l===null){a.error("Could not locate element '"+k+"' to update.");return}return l.trigger(d.zone.refresh,{url:i})})};return{deferredZoneUpdate:f,events:d}})}).call(this);