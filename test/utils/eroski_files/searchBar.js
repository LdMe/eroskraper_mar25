(function(){define(["jquery","common/layer/overlay","common/scroll/scrolling","common/config/device","common/scroll/customScroll"],function(D,L,N,K,b){var B=D(".search-bar");var C=D("#searchTerm");var f=D(".search-word-result");var c=D(".multisearchDisplacer");var q=100;var I;var r=D(".purchasing-process-item-hidden");var E;const w=400;function J(){I=parseInt(C.css("padding-left"),10);if(K.isMobile()){A()}M();H();h()}function h(){D(".search-input").on("keydown",function(O){if(O.keyCode==13){D(".search-button").focus();return false}return true})}function e(){b.init()}function A(){D(".search-menu a").on("click",function(P){if(P){P.preventDefault()}D(".header").removeClass("open-menu");var O=D(".product-menu");if(D(this).hasClass("active")){D(this).removeClass("active");B.removeClass("active");D(".searchForm").removeClass("active");B.stop().hide();D(".shopping-cart-bar .search-result").removeClass("opened");C.val("");f.hide();D(".search-button").hide();if(K.isMobile()){D(".header").removeClass("search-bar-open");D(".product-item-sheet-layer").removeClass("layer-searchbar-open")}if(K.isMobileSmaller()){D("body").removeClass("overflow")}if(D(".product-menu").hasClass("fixed")){O.animate({top:"100px"})}i();m();return true}D(".search-menu a").removeClass("active");D(this).addClass("active");B.addClass("active");B.stop().show();D(".searchForm").addClass("active");D(".search-button").hide();C.attr("placeholder",C.attr("data-placeholder2")).focus();if(D(".product-menu").hasClass("fixed")){O.animate({top:"141px"})}if(K.isMobile()){D(".header").addClass("search-bar-open");if(K.isIOS()){D(".user-bar .login-check .checkout").removeClass("active");D(".user-bar .login-check .checkout .checkout-layer").removeClass("active");D(".header").removeClass("open-menu")}if(D(".header").hasClass("search-bar-open")){D(".product-item-sheet-layer").addClass("layer-searchbar-open")}}})}function p(){D(".shopping-cart-bar .search-result").empty();D(".shopping-cart-bar .search-result").removeClass("opened");D(this).attr("placeholder",C.attr("data-placeholder2"));D(".search-button").hide();if(K.isMobileSmaller()){D("body").removeClass("overflow")}}function x(){D(".search-button").show();var O=C.val();if(K.isDesktop()&&K.isTablet()){D(".search-button").show()}if(K.isMobileSmaller()){D("body").addClass("overflow")}if(O.indexOf(",")==-1){C.val(l(O));if(!D(".shopping-cart-bar .search-result").hasClass("opened")){D(".shopping-cart-bar .search-result").addClass("opened");if(K.isMobileSmaller()&&K.isIOS()){N.removeScrollingiOS(145)}}if(O.length>2){clearTimeout(E);E=setTimeout(n,w)}}else{D(".shopping-cart-bar .search-result").removeClass("opened")}u(l(O))}var y=function(O){D(this).attr("placeholder","");D(".search-close").addClass("active");var P=C.val();if(C.val().length<3){p()}else{if(P.trim().length>0){x()}}if(O.keyCode===0||O.keyCode===188){if(O){O.preventDefault()}f.show();D(".search-button").show();if(K.isTablet()){D(".search-button").hide()}if(K.isDesktop()){D(".search-button").hide()}}m()};var k=function(Q){if(Q){Q.preventDefault()}D(this).attr("placeholder","");D(".search-close").addClass("active");var P=Q.clipboardData||Q.originalEvent.clipboardData||window.clipboardData;var O=P.getData("text");if(O.indexOf(",")!=-1){O=O+","}C.val(O);if(C.val().length<3){p()}else{x()}if(C.val().indexOf(",")!=-1){f.show();D(".search-button").show();if(K.isTablet()){D(".search-button").hide()}if(K.isDesktop()){D(".search-button").hide()}}m()};var j=function(O){if(O){O.preventDefault()}if(K.isDesktop()){D(".search-button").hide();C.attr("placeholder",C.attr("data-placeholder1"))}if(K.isTablet()){D(".search-button").hide();C.attr("placeholder",C.attr("data-placeholder2"))}if(K.isMobile()){C.attr("placeholder",C.attr("data-placeholder2"));D(".search-button").hide()}if(K.isMobileSmaller()){D("body").removeClass("overflow")}f.hide();D(".shopping-cart-bar .search-result").removeClass("opened");C.val("")};function n(){D("#suggestFormInput").val(C.val());D("#suggestForm").submit()}function H(){if(K.isDesktop()){M();C.on("focus",function(){D(this).attr("placeholder",C.attr("data-placeholder2"));D(".search-button").hide();D(".search-close").addClass("active")});C.on("focusout",function(){if(C.val().length>3){D(".search-button").show()}})}var O=null;C.keyup(function(R){var P=null;if(K.isTouch()){P=function(){y(R)}}else{var Q=R.which||R.keyCode;if(d(Q)){P=function(){y(R)}}}clearTimeout(O);O=setTimeout(P,q)});C.keydown(function(){clearTimeout(O)});C.on("paste",k);D(".remove-word").off("click",j).on("click",j);C.keyup(function(P){P.stopPropagation()});if(K.isDesktop()&&!K.isTablet()){D(window).click(function(P){if(!D(P.target).hasClass("coupon-activate")){D(".shopping-cart-bar .search-result").removeClass("opened")}});D(".shopping-cart-bar .search-result").click(function(P){if(!D(P.target).hasClass("coupon-activate")){P.stopPropagation()}})}v()}function d(O){if(O>=48&&O<=90||O>=96&&O<=105||O===188||O===8||O===46||O===32){return true}return false}function M(){C.on("focus",function(){B.addClass("activated");D(".search-close").addClass("active");r.show();if(K.isDesktop()){D(".shopping-cart-bar .search-result").css("top","5rem");r.hide()}})}function v(){D(".search-close").on("click",function(){B.removeClass("activated");r.hide();D(".shopping-cart-bar .search-result").removeClass("opened");D(".search-button").hide();f.hide();C.val("");D(".search-close").removeClass("active");C.attr("placeholder",C.attr("data-placeholder1"));i();m()})}function F(R){var P="";for(var O=0;O<R.length;O++){R[O]=a(R[O]);var Q=O+1;if(Q<10){Q="0"+Q}if(R[O]!=""){P+='<span class="search-word" id="datop_'+O+'">'+R[O]+"</span>";P+='<a class="remove-word" rel="nofollow" href="#resultado'+Q+'" id="dato_'+O+'"></a>';if(O<R.length-1){P+=", "}}}P+="";c.html(P);c.find("a").click(function(){var S=Number(D(this).attr("id").substring(D(this).attr("id").indexOf("_")+1,D(this).attr("id").length));R.splice(S,1);u(l(R.toString()));m()});f.show()}function u(O){if(typeof O!=="undefined"){var P=O.split(",");C.val(O.replace(/&nbsp;/g,"").replace(/\s+/g," "));if(P.length!=1){F(P)}else{i()}}}function i(){c.html("");f.hide()}function a(O){return G(t(O))}function t(P){var O=0;while(O<P.length&&P[O]==" "){O++}return P.substring(O,P.length)}function G(O){var P=O.length-1;while(P>0&&O[P]==" "){P-=1}return O.substring(0,P+1)}var z="(?:[^\"'>]|\"[^\"]*\"|'[^']*')*";var s=new RegExp("<(?:!--(?:(?:-*[^->])*--+|-?)|script\\b"+z+">[\\s\\S]*?<\/script\\s*|style\\b"+z+">[\\s\\S]*?</style\\s*|/?[a-z]"+z+")>","gi");function l(O){var P;do{P=O;O=O.replace(s,"")}while(O!==P);return O.replace(/</g,"")}function m(){C.css("padding-left",g())}function o(){D(".shopping-cart-bar .search-result").addClass("opened")}function g(){if(f&&f.filter(":visible").length){var Q=0;var O=f.find(".remove-word");var R=O.first().width();var P=O.first().outerWidth(true)-R;if(O&&O.length){Q=O.length*R;Q+=(O.length-1)*P}return I+Q}return""}D(document).on("doReset",function(){B.attr("style","");D(".search-menu a").removeClass("active");B.removeClass("active");B.removeClass("activated");D(".search-button").hide();D(".searchForm").removeClass("active");D(".search-result").removeClass("opened");D(".search-close").removeClass("active");D(".shopping-cart-bar .search-result").css("top","");C.val("");D(".header").removeClass("search-bar-open");D(".product-item-sheet-layer").removeClass("layer-searchbar-open");C.attr("placeholder",C.attr("data-placeholder1"));C.blur();C.off();D(".search-menu a").off();D(".remove-word").off();D(".search-close").off();D(".shopping-cart-bar .search-result").off();J()});return{init:J,initScrollbar:e,slideDownSearchBox:o}})}).call(this);