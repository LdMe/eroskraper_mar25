(function(){define(["jquery","t5/core/dom","t5/core/events","common/zone/zoneAppender","common/scroll/scrollEvent","materialize"],function(g,f,o,a,h,k){var j={};var l=true;var c={};var d={};function n(p){if(!j[p]){j[p]=0}var q={eventName:d[p].zoneId,offset:d[p].offset,handler:function(){if(g("#"+d[p].zoneId).parent(".foldable").hasClass("closed")){return}if(l===true){l=false;j[p]++;m(p)}}};if(d[p].selector){g.extend(q,{selector:d[p].selector})}h.on(q)}function i(p){n(p);f.onDocument(a.events.zone.didUpdate,"#"+d[p].zoneId,function(q){if(g(q.nativeEvent.target).hasClass("quantities-combo")||g(q.nativeEvent.target).hasClass("tooltip-icon")||g(q.nativeEvent.target).hasClass("coupon-button-zone")){return}if(q.memo.hasAppended!==true){h.off({eventName:d[p].zoneId})}this.attr("data-zone-parameters","");l=true});f.onDocument(a.events.zone.willUpdate,"#"+d[p].zoneId,function(){var r,q;var s=this.find(".ajax-loading");for(r=0,q=s.length;r<q;r++){s[r].remove()}});if(d[p].extraParamZoneId){f.onDocument(o.zone.didUpdate,"#"+d[p].extraParamZoneId,function(q){if(q.nativeEvent.target.id=="supermarketProductZone"){j[p]=0;n(p)}})}}function e(q,p){if(p){j[q.zoneId]=p}if(g(".footer").filter(":visible").length){q.offset=q.offset-g(".footer .footer-main-content").innerHeight()}var r={zoneId:"",offset:0,eventUri:"",pageParamName:""};g.extend(r,q);d[r.zoneId]=r;if(!c[r.zoneId]){i(r.zoneId);c[r.zoneId]=true}}function m(q){var r={};r[d[q].pageParamName]=j[q];var s={};if(d[q].extraParamZoneId){var p=g("#"+d[q].extraParamZoneId).attr("data-zone-parameters");s=p&&JSON.parse(p)}g("#"+d[q].zoneId).append('<div class="ajax-loading"><div></div></div>');g("#"+d[q].zoneId).attr("data-zone-parameters",JSON.stringify(g.extend(r,s)));a.deferredZoneUpdate(d[q].zoneId,d[q].eventUri)}function b(p){if(j[p]==-1){l=false;j[p]=0;m(p)}}return{init:e,loadFirstPage:b}})}).call(this);